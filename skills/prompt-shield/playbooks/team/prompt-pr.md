# Prompt PR 룰

You are a senior prompt engineer reviewing prompt changes in pull requests.

## Tool Usage

이 규칙을 적용할 때 사용하는 도구:
- `git diff` - 프롬프트 변경 확인
- `/ps:lint` - 품질 검증

프롬프트 변경을 안전하게 관리하기 위한 PR(Pull Request) 규칙입니다.

**핵심 원칙: 프롬프트 변경 = 코드 변경**

---

## 기본 원칙

```
┌─────────────────────────────────────────────────────────────┐
│                    Prompt PR 5대 원칙                        │
├─────────────────────────────────────────────────────────────┤
│  1. PR로만 반영         구두/DM 배포 금지                    │
│  2. Before/After 필수   변경 전후 비교                       │
│  3. 테스트 케이스 필수  최소 5개                             │
│  4. 리스크 섹션         안전/정책 영향 시 필수               │
│  5. 우선순위            안정성 > 기능 > 편의                 │
└─────────────────────────────────────────────────────────────┘
```

---

## PR 템플릿

```markdown
## 목적 (GOAL)
[이 변경의 목적을 한 문장으로]

## 사용 맥락 (CONTEXT)
- 도메인/대상:
- 영향 범위:

## 변경 유형
- [ ] New (신규)
- [ ] Improve (개선)
- [ ] Hotfix (긴급 수정)
- [ ] Security (보안/정책)
- [ ] Breaking (호환성 깨짐)

## 변경 요약 (3줄)
1.
2.
3.

## Before → After

### Before
```
[원본 프롬프트 또는 해당 부분]
```

### After
```
[변경된 프롬프트 또는 해당 부분]
```

### 변경 이유
[왜 이렇게 변경했는지]

## 성공 기준 (SUCCESS_CRITERIA)
- [ ] 기준 1
- [ ] 기준 2
- [ ] 기준 3

## 테스트 케이스 (TESTS)
### 정상 케이스
1.
2.

### 엣지 케이스
1.

### 인젝션 방어 케이스
1.

### 도메인 특이 케이스
1.

## 리스크/안전 체크 (해당 시)
- [ ] PII/민감정보 처리 확인
- [ ] 확답 금지 영역 확인
- [ ] 인젝션 방어 확인

## 롤백 계획
[문제 발생 시 이전 버전으로 되돌리는 방법]
```

---

## 리뷰 체크리스트

### 품질 체크

- [ ] 목표/대상/범위가 명확한가?
- [ ] 모호한 표현이 규칙/제약/예시로 치환됐는가?
- [ ] 출력 형식이 강제되는가 (필수 키/섹션/길이)?
- [ ] 성공 기준이 검증 가능한가?

### 안정성 체크 (회귀)

- [ ] 테스트 케이스 5개 이상인가?
- [ ] 과거 실패 케이스가 회귀 세트에 포함됐는가?
- [ ] 기존 사용처 호환성이 유지되는가?

### 안전/보안 체크

- [ ] 입력 데이터 속 지시(인젝션)를 따르지 않도록 했는가?
- [ ] 근거 없는 단정 방지 규칙이 있는가?
- [ ] 정책 민감 영역은 확답 대신 절차/확인 중심인가?

---

## 승인/머지 기준

| 변경 유형 | 리뷰어 | 추가 조건 |
|-----------|--------|------------|
| 경미한 변경 | 1명 | 테스트 통과 |
| 주요 변경 | 2명 | 오너 승인 + 회귀 세트 통과 |
| Hotfix | 1명 (빠른 머지) | 24시간 내 회귀 세트 보강 PR |
| Breaking | 2명 + 오너 | 마이그레이션 계획 필수 |

---

## 변경 유형별 가이드

### New (신규)
- 새로운 프롬프트 추가
- 기존 시스템에 영향 없음
- 테스트 케이스 5개 필수

### Improve (개선)
- 기존 프롬프트 품질 향상
- 동작 호환성 유지
- Before/After 비교 필수

### Hotfix (긴급 수정)
- 프로덕션 문제 긴급 대응
- 빠른 머지 허용
- 24시간 내 회귀 테스트 보강

### Security (보안/정책)
- 인젝션 방어, 정책 준수
- 리스크 섹션 필수
- 보안 리뷰어 필수

### Breaking (호환성 깨짐)
- 출력 형식 변경
- 기존 연동 시스템 영향
- 마이그레이션 가이드 필수

---

## 관련 참조

- [owner-guide.md](owner-guide.md) - 오너 제도
- [regression-testing.md](regression-testing.md) - 회귀 테스트
- [../../references/team-workflow.md](../../references/team-workflow.md) - 팀 운영 가이드
